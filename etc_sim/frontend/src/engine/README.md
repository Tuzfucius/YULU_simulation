# 仿真引擎核心 (Simulation Engine Core)

本目录包含了系统的核心仿真逻辑，负责交通流的物理计算、异常模拟及数据采样。

## 核心文件说明

| 文件 | 功能描述 |
|------|---------|
| `SimulationEngine.ts` | **仿真主驱动**：管理全局仿真循环（RequestAnimationFrame）、状态同步（WebSocket）、统计数据准备及向状态机推送数据。 |
| `Vehicle.ts` | **车辆个体模型**：实现 IDM 跟驰算法与 MOBIL 换道逻辑。包含精准的动态边界检测机制，确保异构路网下的统计准确性。 |
| `config.ts` | **算法参数集**：定义了物理常数（如 IDM 加速度、换道收益阈值）、颜色主题及采样步长。 |

## 数据流机制
1. **输入**：从 `simStore` 获取环境与车辆配置参数。
2. **计算**：每帧（约 16ms）依序更新所有车辆的位置、速度与车道。
3. **输出**：
   - **实时**：通过 WebSocket 向后端或 Canvas 推送状态快照。
   - **累计**：在 `this.sampledTrajectoryData` 中保存关键帧采样。
   - **终态**：仿真结束后聚合生成 `statistics` 对象供可视化组件使用。

## 机制解读
- **动态边界检测**：详见核心文档 [MECHANISMS.md](../../docs/MECHANISMS.md)。
- **异常车辆逻辑**：支持三类异常行为，通过修改车辆的期望速度和加速度上限来模拟事故及波动。
